<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="description" content="" />
<meta name="author" content="" />
<title>Quản trị</title>
<link
	href="https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css"
	rel="stylesheet" />

<!-- th:href="@{path}" de dieu huong-->
<link th:href="@{/admin1/assets/css/styles.css}" rel="stylesheet" />

<script
	src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"
	crossorigin="anonymous"></script>

<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
	crossorigin="anonymous"></script>

<script th:src="@{/admin1/assets/js/scripts.js}"></script>

<script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest"
	crossorigin="anonymous"></script>

<script type="text/javascript"
	th:src="@{/admin1/assets/js/datatables-simple-demo.js}"></script>

<script
	src="https://cdn.ckeditor.com/ckeditor5/29.0.0/classic/ckeditor.js"></script>
</head>

<body class="sb-nav-fixed">
	<nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
		<nav th:fragment="html_nav"
			class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
			<!-- Navbar Brand-->
			<a class="navbar-brand ps-3" th:href="@{/adminHomePage/home}">QUẢN
				TRỊ</a>
			<!-- Sidebar Toggle-->
			<button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0"
				id="sidebarToggle" href="#!">
				<i class="fas fa-bars"></i>
			</button>

			<!-- Navbar-->
			<!-- 
	        <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
	            <li class="nav-item dropdown">
	                <a th:if="${session.admin}" class="nav-link dropdown-toggle" href="/admin/logout" role="button" ><i class="fas fa-user fa-fw"></i><span> Logout</span></a>
	                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown1">
	                    <li><a class="dropdown-item" href="#">Settings</a></li>
	                    <li><a class="dropdown-item" href="#">Activity Log</a></li>
	                    <li>
	                        <hr class="dropdown-divider" />
	                    </li>
	                    <li><a class="dropdown-item" href="/logout">Logout</a></li>
	                </ul>
	            </li>
	        </ul>
         -->
		</nav>
	</nav>

	<div id="layoutSidenav">
		<div id="layoutSidenav_nav">
			<div th:fragment="html_menu" id="layoutSidenav_nav">
				<nav class="sb-sidenav accordion sb-sidenav-dark"
					id="sidenavAccordion">
					<div class="sb-sidenav-menu">
						<div class="nav">

							<!-- dieu huong toi trang can toi thong qua cac requestmapping -->
							<a class="nav-link" th:href="@{/adminUserPage/users}">
								<div class="sb-nav-link-icon">
									<i class="fas fa-tachometer-alt"></i>
								</div> Quản lý người dùng
							</a> <a class="nav-link" th:href="@{/adminDonationPage/donations}">
								<div class="sb-nav-link-icon">
									<i class="fas fa-tachometer-alt"></i>
								</div> Quản lý đợt quyên góp
							</a>
						</div>
					</div>

				</nav>
			</div>
		</div>

		<div id="layoutSidenav_content">
			<main>
				<div class="container-fluid px-4">
					<h1 class="mt-4">Danh sách người dùng</h1>
					<div class="card mb-4">
						<div class="card-header">
							<button type="button" class="btn btn-success"
								data-bs-toggle="modal" data-bs-target="#exampleModalAdd">
								Thêm mới</button>
							<!-- Modal Add-->
							<div class="modal fade" id="exampleModalAdd" tabindex="-1"
								aria-labelledby="exampleModalLabel" aria-hidden="true">
								<div class="modal-dialog modal-lg">
									<div class="modal-content">
										<div class="modal-header">
											<h5 class="modal-title" id="exampleModalLabelll">Thêm
												mới</h5>
											<button type="button" class="btn-close"
												data-bs-dismiss="modal" aria-label="Close"></button>
										</div>

										<div class="modal-body">

											<form action="#" th:action="@{/adminUserPage/saveUser}"
												th:object="${saveUser}" method="post"
												enctype="multipart/form-data">
												<div class="row">
													<div class="col-6">
														<label for="addname" class="col-form-label">Name:</label>
														<input type="text" class="form-control" id="addname"
															name="fullName" required th:field="*{fullName}">
													</div>
													<div class="col-6">
														<label for="addcost" class="col-form-label">Email:</label>
														<input type="email" class="form-control" id="addcost"
															name="email" required th:field="*{email}">
													</div>
												</div>
												<div class="row">
													<div class="col-6">
														<label for="addname" class="col-form-label">Số
															điện thoại:</label> <input type="number" class="form-control"
															id="addname" name="phoneNumber" required
															th:field="*{phoneNumber}">
													</div>
													<div class="col-6">
														<label for="addcost" class="col-form-label">Địa
															chỉ:</label> <input type="text" class="form-control" id="addcost"
															name="address" required th:field="*{address}">
													</div>
												</div>
												<div class="row">
													<div class="col-6">
														<label for="addname" class="col-form-label">Tài
															khoản:</label> <input type="text" class="form-control"
															id="addname" name="userName" required
															th:field="*{userName}">
													</div>
													<div class="col-6">
														<label for="addcost" class="col-form-label">Mật
															khẩu:</label> <input type="password" class="form-control"
															id="addcost" name="password" required
															th:field="*{password}">
													</div>
													<div class="col-6">
														<label for="ct_id" class="col-form-label">Vai trò:</label>
														<select class="form-control" id="ct_id" name="idRole"
															required th:field="*{role}">
															<option value="admin">admin</option>
															<option value="user" selected>user</option>
														</select>
													</div>


												</div>

												<div class="modal-footer">
													<button type="button" class="btn btn-secondary"
														data-bs-dismiss="modal">Đóng</button>
													<button type="submit" class="btn btn-primary">Thêm</button>
												</div>
											</form>

										</div>

									</div>
								</div>
							</div>
						</div>
						<div class="card-body">


							<!-- id=datatablesSimple de setup phan trang va search -->
							<table id="datatablesSimple">
								<thead>
									<tr style="background-color: gray !important;">
										<th>Họ tên</th>
										<th>Email</th>
										<th>Số điện thoại</th>
										<th>Tài khoản</th>
										<th>Vai trò</th>
										<th>Trạng thái</th>
										<th>Hành động</th>
									</tr>
								</thead>
								<tfoot>
									<tr>

									</tr>
								</tfoot>
								<tbody>								
									<!-- Hien thi danh sach user -->
									<th:block th:each="user : ${users}">
										<tr>
											<td th:text="${user.fullName}"></td>
											<td th:text="${user.email}"></td>
											<td th:text="${user.phoneNumber}"></td>
											<td th:text="${user.userName}"></td>
											<td th:text="${user.role}"></td>
											<td th:if="${user.status == 1}"
												style="color: #1c7430; font-weight: bold">Hoạt động</td>
											<td th:if="${user.status == 0}"
												style="color: red; font-weight: bold">Đã khóa</td>

											<td style="width: 270px">

												<button type="button" style="width: 80px"
													class="btn btn-success" data-bs-toggle="modal"
													th:data-bs-target="'#idModelMail'+${user.id}">Gửi</button>

												<button type="button" style="width: 80px"
													class="btn btn-primary" data-bs-toggle="modal"
													th:data-bs-target="'#exampleModal'+${user.id}">Sửa</button>
												<button type="button" style="width: 80px"
													class="btn btn-warning" data-bs-toggle="modal"
													th:data-bs-target="'#idModelDetail'+${user.id}">
													Chi tiết</button>
												<button type="button" style="width: 80px"
													class="btn btn-danger mt-1" data-bs-toggle="modal"
													th:data-bs-target="'#idModelDel'+${user.id}">Xóa</button>
												<form th:if="${user.status == 1}"
													th:action="@{/adminUserPage/lock}" method="post"
													style="margin-left: 85px; margin-top: -38px">
													<input type="hidden" class="form-control" id="id"
														name="idUser" th:value="${user.id}">
													<button type="submit" style="width: 80px"
														class="btn btn-danger">Khóa</button>
												</form>

												<form th:if="${user.status == 0}"
													th:action="@{/adminUserPage/lock}" method="post"
													style="margin-left: 85px; margin-top: -38px">
													<input type="hidden" class="form-control" id="id"
														name="idUser" th:value="${user.id}">
													<button type="submit" style="width: 80px"
														class="btn btn-success">Mở</button>
												</form>

												<div class="modal fade" th:id="'idModelDel' + ${user.id}"
													tabindex="-1" aria-labelledby="exampleModalLabel"
													aria-hidden="true">
													<div class="modal-dialog">
														<div class="modal-content">
															<div class="modal-header">
																<h5 class="modal-title" id="exampleModalLabel">Bạn
																	chắc chắn muốn xóa ?</h5>
																<button type="button" class="btn-close"
																	data-bs-dismiss="modal" aria-label="Close"></button>
															</div>
															<div class="modal-body">
																Người dùng : <span th:text="${user.fullName}"></span>
																<form th:action="@{/adminUserPage/delete}" method="post">
																	<input type="hidden" class="form-control" id="id"
																		name="idUser" th:value="${user.id}">
																	<div class="modal-footer" style="margin-top: 20px">
																		<button type="button" class="btn btn-secondary"
																			data-bs-dismiss="modal">Close</button>
																		<button type="submit" class="btn btn-danger">Xóa</button>

																	</div>
																</form>
															</div>

														</div>
													</div>
												</div>
												<div class="modal fade" th:id="'idModelMail' + ${user.id}"
													tabindex="-1" aria-labelledby="exampleModalLabel"
													aria-hidden="true">
													<div class="modal-dialog">
														<div class="modal-content">
															<div class="modal-header">
																<h5 class="modal-title" id="exampleModalLabel">
																	Gửi đến: <span th:text="${user.email}"></span>
																</h5>
																<button type="button" class="btn-close"
																	data-bs-dismiss="modal" aria-label="Close"></button>
															</div>
															<div class="modal-body">
																<form th:action="@{/adminUserPage/send-mail}"
																	method="post">
																	<input type="hidden" class="form-control" id="id"
																		name="idUser" th:value="${user.id}"> <label
																		for="addname" class="col-form-label">Nội dung:</label>
																	<textarea rows="10" class="form-control" id="addname"
																		name="note"></textarea>
																	<div class="modal-footer" style="margin-top: 20px">
																		<button type="button" class="btn btn-secondary"
																			data-bs-dismiss="modal">Đóng</button>
																		<button type="submit" class="btn btn-success">Gửi</button>

																	</div>
																</form>

															</div>

														</div>
													</div>
												</div>
												<div class="modal fade" th:id="'idModelDetail' + ${user.id}"
													tabindex="-1" aria-labelledby="exampleModalLabel"
													aria-hidden="true">
													<div class="modal-dialog modal-lg">
														<div class="modal-content">
															<div class="modal-header">
																<h5 class="modal-title" id="exampleModalLabel">
																	Chi tiết : <span th:text="${user.fullName}"></span>
																</h5>
																<button type="button" class="btn-close"
																	data-bs-dismiss="modal" aria-label="Close"></button>
															</div>
															<div class="modal-body">
																<div class="row">
																	<div class="col-6">
																		<h5>Họ tên :</h5>
																		<p th:text="${user.fullName}"></p>
																		<h5>Email:</h5>
																		<p th:text="${user.email}"></p>
																		<h5>Số điện thoại:</h5>
																		<p th:text="${user.phoneNumber}"></p>
																		<h5>Tài khoản:</h5>
																		<p th:text="${user.userName}"></p>
																	</div>
																	<div class="col-6">
																		<h5>Địa chỉ :</h5>
																		<p th:text="${user.address}"></p>

																		<h5>Vai trò:</h5>
																		<p th:text="${user.role}"></p>

																		<h5>Note:</h5>
																		<p th:text="${user.note}"></p>
																	</div>

																</div>
															</div>
														</div>
													</div>
												</div>
											</td>
										</tr>

										<!-- Modal Update-->
										<div class="modal fade" th:id="'exampleModal'+${user.id}"
											tabindex="-1" aria-labelledby="exampleModalLabel"
											aria-hidden="true">
											<div class="modal-dialog modal-lg ">
												<div class="modal-content">
													<div class="modal-header">
														<h5 class="modal-title" id="exampleModalLabell">Cập
															nhật</h5>
														<button type="button" class="btn-close"
															data-bs-dismiss="modal" aria-label="Close"></button>
													</div>
													<div class="modal-body">
														<form enctype="multipart/form-data"
															th:action="@{/adminUserPage/saveUser}"
															th:object="${saveUser}" method="post">
															<div class="row">
																<div class="col-6">
																	<label for="addname" class="col-form-label">Họ
																		và tên:</label> <input type="text" class="form-control"
																		id="addname" name="fullName" required
																		th:field="*{fullName}">
																</div>
																<div class="col-6">
																	<label for="addcost" class="col-form-label">Email:</label>
																	<input readonly type="email" class="form-control"
																		id="addcost" name="email" required th:name="email"
																		th:value="${user.email}">
																</div>
															</div>
															<div class="row">
																<div class="col-6">
																	<label for="addname" class="col-form-label">Số
																		điện thoại:</label> <input type="number" class="form-control"
																		id="addname" name="phoneNumber" required
																		th:field="*{phoneNumber}">
																</div>
																<div class="col-6">
																	<label for="addcost" class="col-form-label">Địa
																		chỉ:</label> <input type="text" class="form-control"
																		id="addcost" name="address" required
																		th:field="*{address}">
																</div>
															</div>
															<div class="row">
																<div class="col-6">
																	<label for="addname" class="col-form-label">Tài
																		khoản:</label> <input readonly type="text"
																		class="form-control" id="addname" name="userName"
																		required th:name="userName"
																		th:value="${user.userName}"> <input readonly
																		type="number" style="display: none"
																		class="form-control" id="addname" name="idUser"
																		required th:name="id" th:value="${user.id}"> <input
																		readonly type="hidden" class="form-control"
																		id="addname" name="password" required
																		th:name="password" th:value="${user.password}">
																	<input readonly type="number" style="display: none"
																		class="form-control" id="addname" name="status"
																		required th:name="status" th:value="${user.status}">
																	<input readonly type="hidden" class="form-control"
																		id="addname" name="note" required th:name="note"
																		th:value="${user.note}">
																</div>
																<div class="col-6">
																	<label for="ct_id" class="col-form-label">Vai
																		trò:</label> <select class="form-control" id="ct_id"
																		th:name="role" required>

																		<option th:value="admin" th:text="admin" selected></option>
																		<option th:value="user" th:text="user" selected></option>
																	</select>
																</div>
															</div>
															<div class="modal-footer">
																<button type="button" class="btn btn-secondary"
																	data-bs-dismiss="modal">Đóng</button>
																<button type="submit" class="btn btn-primary">Lưu
																</button>
															</div>
														</form>
													</div>

												</div>
											</div>
										</div>
									</th:block>
								</tbody>
							</table>
						</div>
					</div>
				</div>

			</main>

			<footer> </footer>
		</div>
	</div>

	<script src="js/JQuery3.3.1.js"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
		crossorigin="anonymous"></script>
	<script src="js/scripts.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest"
		crossorigin="anonymous"></script>
	<script src="js/datatables-simple-demo.js"></script>
</body>

</html>